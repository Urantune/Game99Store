CREATE DATABASE Game99Store;
GO
USE Game99Store;
GO

CREATE TABLE dbo.[User] (
    user_Id UNIQUEIDENTIFIER NOT NULL DEFAULT NEWID(),
    userName NVARCHAR(255) NOT NULL,
    [password] NVARCHAR(255) NOT NULL,
    dateCreateAcc DATETIME2(0) NOT NULL,
    score INT NULL,
    [status] NVARCHAR(255) NULL,
    userType INT NULL,
    email NVARCHAR(255) NOT NULL,
    imageLinks NVARCHAR(MAX) NULL,
    CONSTRAINT PK_User PRIMARY KEY CLUSTERED (user_Id),
    CONSTRAINT UQ_User_userName UNIQUE (userName),
    CONSTRAINT UQ_User_email UNIQUE (email)
);
GO

CREATE TABLE dbo.Admin (
    admin_id UNIQUEIDENTIFIER NOT NULL DEFAULT NEWID(),
    adminName NVARCHAR(255) NOT NULL,
    [password] NVARCHAR(255) NOT NULL,
    dateCreateAcc DATETIME2(0) NOT NULL,
    CONSTRAINT PK_Admin PRIMARY KEY CLUSTERED (admin_id)
);
GO

CREATE TABLE dbo.Game (
    game_id UNIQUEIDENTIFIER NOT NULL DEFAULT NEWID(),
    gameName NVARCHAR(255) NOT NULL,
    price DECIMAL(10,2) NOT NULL,
    [version] NVARCHAR(255) NULL,
    [status] NVARCHAR(255) NULL,
    category NVARCHAR(255) NULL,
    locateGame NVARCHAR(255) NULL,
    imageLinks NVARCHAR(MAX) NULL,
    CONSTRAINT PK_Game PRIMARY KEY CLUSTERED (game_id)
);
GO

CREATE TABLE dbo.feedbackGame (
    feedback_id UNIQUEIDENTIFIER NOT NULL DEFAULT NEWID(),
    game_id UNIQUEIDENTIFIER NOT NULL,
    user_id UNIQUEIDENTIFIER NOT NULL,
    comment NVARCHAR(255) NULL,
    star INT NULL,
    date_created DATETIME2(0) NOT NULL,
    CONSTRAINT PK_feedbackGame PRIMARY KEY CLUSTERED (feedback_id),
    CONSTRAINT FK_feedbackGame_Game FOREIGN KEY (game_id) REFERENCES dbo.Game(game_id),
    CONSTRAINT FK_feedbackGame_User FOREIGN KEY (user_id) REFERENCES dbo.[User](user_Id)
);
GO

CREATE TABLE dbo.UserGame (
    user_id UNIQUEIDENTIFIER NOT NULL,
    game_id UNIQUEIDENTIFIER NOT NULL,
    purchase_date DATETIME2(0) NOT NULL,
    price DECIMAL(10,2) NOT NULL,
    CONSTRAINT PK_UserGame PRIMARY KEY CLUSTERED (user_id, game_id),
    CONSTRAINT FK_UserGame_User FOREIGN KEY (user_id) REFERENCES dbo.[User](user_Id),
    CONSTRAINT FK_UserGame_Game FOREIGN KEY (game_id) REFERENCES dbo.Game(game_id)
);
GO

CREATE TABLE dbo.[Event] (
    event_id UNIQUEIDENTIFIER NOT NULL DEFAULT NEWID(),
    imageLinks NVARCHAR(MAX) NULL,
    [type] NVARCHAR(255) NULL,
    info NVARCHAR(255) NULL,
    date_start DATE NOT NULL,
    date_end DATE NOT NULL,
    CONSTRAINT PK_Event PRIMARY KEY CLUSTERED (event_id)
);
GO

CREATE TABLE dbo.voucher (
    voucherid UNIQUEIDENTIFIER NOT NULL DEFAULT NEWID(),
    [name] NVARCHAR(255) NOT NULL,
    sale INT NOT NULL,
    [type] NVARCHAR(255) NULL,
    date_start DATE NOT NULL,
    date_end DATE NOT NULL,
    imageLinks NVARCHAR(MAX) NULL,
    CONSTRAINT PK_voucher PRIMARY KEY CLUSTERED (voucherid)
);
GO
